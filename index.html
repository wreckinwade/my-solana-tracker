<script>
    // I have updated these to the exact case-sensitive IDs Jupiter requires
    const SOL_ID = 'So11111111111111111111111111111111111111112';
    const JUPSOL_ID = 'vSo1YnoBsnLkyZ9f7fUofmP8H5rYat98yN7U6Yndf6r';

    async function getPrices() {
        const status = document.getElementById('status');
        try {
            status.innerHTML = "> FETCHING DATA...";
            
            // We add a 'timestamp' to the end to prevent Vercel from showing "Old" data
            const url = `https://api.jup.ag/price/v2?ids=${SOL_ID},${JUPSOL_ID}&time=${Date.now()}`;
            
            const response = await fetch(url);
            
            if (!response.ok) {
                throw new Error(`Server Error: ${response.status}`);
            }

            const result = await response.json();

            // Check if the data actually exists in the response
            if (result.data && result.data[SOL_ID] && result.data[JUPSOL_ID]) {
                const solData = result.data[SOL_ID].price;
                const jupData = result.data[JUPSOL_ID].price;

                document.getElementById('sol-price').innerText = `$${parseFloat(solData).toFixed(2)}`;
                document.getElementById('jupsol-price').innerText = `$${parseFloat(jupData).toFixed(2)}`;

                const premium = ((jupData / solData - 1) * 100).toFixed(2);
                document.getElementById('premium-val').innerText = `Yield Premium: +${premium}%`;

                status.innerHTML = `> UPDATE SUCCESS: ${new Date().toLocaleTimeString()}`;
            } else {
                status.innerHTML = `> ERROR: Token data not found in API response.`;
            }

        } catch (error) {
            status.innerHTML = `> CONNECTION ERROR: ${error.message}`;
            console.error("Full Error:", error);
        }
    }

    getPrices();
    setInterval(getPrices, 15000);
</script>
